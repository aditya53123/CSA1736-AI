import heapq

def a_star(graph, start, goal, heuristic):
    """
    Implements the A* search algorithm for finding the shortest path.

    Args:
        graph (dict): Nodes and their neighbors/costs. Format: {node: [(neighbor, cost), ...]}
        start: Starting node.
        goal: Target node.
        heuristic (dict): Estimated cost from a node to the goal (h(n)).
    """
    # g_score: Cost from start along best path found so far
    g_score = {node: float('inf') for node in graph}
    g_score[start] = 0

    # f_score: g_score[n] + h_score[n] (The main priority value)
    f_score = {node: float('inf') for node in graph}
    f_score[start] = heuristic[start]

    # Priority queue: Stores (f_score, node)
    open_set = [(f_score[start], start)]

    # came_from: Tracks the path
    came_from = {}

    while open_set:
        # Pop node with the lowest f_score
        current_f, current_node = heapq.heappop(open_set)

        if current_node == goal:
            # Reconstruct path
            path = []
            while current_node in came_from:
                path.append(current_node)
                current_node = came_from[current_node]
            path.append(start)
            return path[::-1] # Return path reversed

        # Check neighbors
        for neighbor, cost in graph.get(current_node, []):
            # Tentative g_score (cost from start via current_node)
            tentative_g_score = g_score[current_node] + cost

            if tentative_g_score < g_score[neighbor]:
                # Found a better path to the neighbor
                came_from[neighbor] = current_node
                g_score[neighbor] = tentative_g_score
                f_score[neighbor] = tentative_g_score + heuristic.get(neighbor, float('inf'))
                heapq.heappush(open_set, (f_score[neighbor], neighbor))

    return "Path not found"

# Example Setup
# Graph: (node, cost)
example_graph = {
    'A': [('B', 1), ('C', 4)],
    'B': [('D', 2), ('E', 5)],
    'C': [('F', 3)],
    'D': [('G', 6)],
    'E': [('G', 1)], # This path is shorter if the heuristic is good
    'F': [('G', 4)],
    'G': []
}
# Heuristic (h(n)): Estimate cost from node to goal 'G'
example_heuristic = {
    'A': 7, 'B': 6, 'C': 4,
    'D': 3, 'E': 1, 'F': 2, 'G': 0
}

path = a_star(example_graph, 'A', 'G', example_heuristic)
print(f"Path from A to G: {path}")
